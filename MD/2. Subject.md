# Subject 

- Publisher와 Subscriber 역할을 모두 할 수 있습니다. 

## 1. PassthroughSubject

### 예제
- Subject가 Publisher로 동작하는 예제입니다. [send](https://developer.apple.com/documentation/combine/passthroughsubject/3204648-send)를 통해 이벤트를 보냅니다. 

```swift
class ViewController: UIViewController {
    
    private var cancelBag = Set<AnyCancellable>()

    override func viewDidLoad() {
        super.viewDidLoad()
        
        let subject = PassthroughSubject<Int, Never>()
        
        subject.sink(receiveCompletion: { (completion) in
            print(completion)
        }) { value in
            print(value)
        }.store(in: &cancelBag)
        
        subject.send(1)
        subject.send(2)
        subject.send(completion: .finished)
    }
}

// print
1
2
finished
```

- Subject가 Subscriber로 동작하는 예제입니다.
[subscribe](https://developer.apple.com/documentation/combine/publisher/3204757-subscribe)를 통해 publisher를 구독합니다. 

```swift
func subscribe<S>(_ subject: S) -> AnyCancellable where S : Subject, Self.Failure == S.Failure, Self.Output == S.Output
```

```swift
class ViewController: UIViewController {
    
    private var cancelBag = Set<AnyCancellable>()

    override func viewDidLoad() {
        super.viewDidLoad()
        
        let subject = PassthroughSubject<Int, Never>()
        subject.sink(receiveCompletion: { (completion) in
            print(completion)
        }) { value in
            print(value)
        }.store(in: &cancelBag)
        
        [1,2,3,4].publisher
            .subscribe(subject)
            .store(in: &cancelBag)
    }
}
```


## 2. CurrentValueSubject

- 초기값을 가지는 Subject

### 예제

```swift
class ViewController: UIViewController {
    
    private var cancelBag = Set<AnyCancellable>()

    override func viewDidLoad() {
        super.viewDidLoad()
        
        let subject = CurrentValueSubject<Int, Never>(100)
        
        subject.sink(receiveCompletion: { (completion) in
            print(completion)
        }) { value in
            print(value)
        }.store(in: &cancelBag)

        subject.send(1)
        subject.send(2)
        subject.send(completion: .finished)
    }
}

// print
100
1
2
finished
```



## 3. 추가 

### 3.1 cancel 함수로 구독을 취소할 수 있음. 

```swift
class ViewController: UIViewController {
    
    private var cancelBag = Set<AnyCancellable>()

    override func viewDidLoad() {
        super.viewDidLoad()
        
        let subject = PassthroughSubject<Int, Never>()
        
        let subscriber = subject.sink(receiveCompletion: { (completion) in
            print(completion)
        }) { value in
            print(value)
        }
        subscriber.store(in: &cancelBag)

        subject.send(1)
        subject.send(2)
        
        subscriber.cancel()
        
        subject.send(3)
        subject.send(4)
    }
}


// print
1
2
```



### 3.2 eraseToAnyPublisher 

```swift
let subject = PassthroughSubject<Int, Never>()

// subject의 타입은 PassthroughSubject<Int, Never> 
```



```swift
let subject = PassthroughSubject<Int, Never>().eraseToAnyPublisher()

// subject의 타입은 AnyPublisher<Int, Never>
```

